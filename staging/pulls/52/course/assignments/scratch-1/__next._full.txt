1:"$Sreact.fragment"
2:I[69460,["/staging/pulls/52/_next/static/chunks/3421e88d40c9134c.js","/staging/pulls/52/_next/static/chunks/fbf372f7eb8336a2.js"],"default"]
3:I[24820,["/staging/pulls/52/_next/static/chunks/3421e88d40c9134c.js","/staging/pulls/52/_next/static/chunks/fbf372f7eb8336a2.js"],"default"]
5:I[39795,["/staging/pulls/52/_next/static/chunks/3421e88d40c9134c.js","/staging/pulls/52/_next/static/chunks/fbf372f7eb8336a2.js"],"OutletBoundary"]
6:"$Sreact.suspense"
8:I[39795,["/staging/pulls/52/_next/static/chunks/3421e88d40c9134c.js","/staging/pulls/52/_next/static/chunks/fbf372f7eb8336a2.js"],"ViewportBoundary"]
a:I[39795,["/staging/pulls/52/_next/static/chunks/3421e88d40c9134c.js","/staging/pulls/52/_next/static/chunks/fbf372f7eb8336a2.js"],"MetadataBoundary"]
c:I[8528,[],"default"]
:HL["/staging/pulls/52/_next/static/chunks/7934be6db471e3e4.css","style"]
:HL["/staging/pulls/52/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/staging/pulls/52/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
0:{"P":null,"b":"_UWXVLHEfnk1J1uGfyhdE","c":["","course","assignments","scratch-1",""],"q":"","i":false,"f":[[["",{"children":["course",{"children":["assignments",{"children":[["slug","scratch-1","d"],{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],[["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/staging/pulls/52/_next/static/chunks/7934be6db471e3e4.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":["$","body",null,{"className":"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["$","$1","c",{"children":["$L4",[["$","script","script-0",{"src":"/staging/pulls/52/_next/static/chunks/9bba833e6f3a8653.js","async":true,"nonce":"$undefined"}]],["$","$L5",null,{"children":["$","$6",null,{"name":"Next.MetadataOutlet","children":"$@7"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false]},null,false,false],["$","$1","h",{"children":[null,["$","$L8",null,{"children":"$L9"}],["$","div",null,{"hidden":true,"children":["$","$La",null,{"children":["$","$6",null,{"name":"Next.Metadata","children":"$Lb"}]}]}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],false]],"m":"$undefined","G":["$c",[]],"S":true}
d:I[32888,["/staging/pulls/52/_next/static/chunks/9bba833e6f3a8653.js"],""]
4:["$","div",null,{"className":"min-h-screen bg-white","children":["$","div",null,{"className":"max-w-4xl mx-auto px-6 py-16","children":[["$","$Ld",null,{"href":"/course","className":"text-sm text-blue-600 hover:text-blue-800 mb-8 inline-block","children":"← Back to Course"}],["$","div",null,{"className":"mb-8","children":[["$","h1",null,{"className":"text-4xl font-bold text-gray-900 mb-4","children":"Scratch-1: The Transformer Backbone"}],["$","div",null,{"className":"flex items-center gap-4 text-sm text-gray-600","children":[["$","span",null,{"className":"flex items-center gap-2","children":[["$","svg",null,{"className":"w-4 h-4","fill":"none","stroke":"currentColor","viewBox":"0 0 24 24","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":2,"d":"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"}]}],["$","span",null,{"children":["Due: ","Sunday, February 1, 9:00 AM MST"]}]]}],["$","span",null,{"className":"px-3 py-1 bg-blue-50 text-blue-600 rounded-full font-medium","children":[100," points"]}]]}]]}],["$","div",null,{"className":"prose prose-lg max-w-none","children":"$Le"}],["$","div",null,{"className":"mt-12 pt-8 border-t border-gray-200","children":["$","$Ld",null,{"href":"/course","className":"text-blue-600 hover:text-blue-800 font-medium","children":"← Back to Course"}]}]]}]}]
e:[["$","h1",null,{"children":"Scratch-1: The Transformer Backbone"}],"\n",["$","p",null,{"children":[["$","strong",null,{"children":"Focus"}],": Implementing the ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"O"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mn",null,{"children":"1"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"O(1)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.02778em"},"children":"O"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord","children":"1"}],["$","span",null,{"className":"mclose","children":")"}]]}]}]]}]," engine of the VLA stack."]}],"\n",["$","h2",null,{"children":"1. Objective"}],"\n",["$","p",null,{"children":["In this assignment, you will implement a ",["$","strong",null,{"children":"decoder-only Transformer from scratch"}]," using PyTorch. You will not use ",["$","code",null,{"children":"nn.Transformer"}]," or pre-built ",["$","code",null,{"children":"transformers"}]," library backbones. You will build the attention mechanism, the feed-forward blocks, and the autoregressive training loop."]}],"\n",["$","p",null,{"children":["The goal is to train this model to perform ",["$","strong",null,{"children":"Next-Token Prediction"}]," on a synthetic robotic trajectory dataset."]}],"\n",["$","h3",null,{"children":"The Unified Sequence Hypothesis"}],"\n",["$","p",null,{"children":["This assignment confronts you with the reality of the ",["$","strong",null,{"children":"Unified Sequence Hypothesis"}],": that actions, pixels, and words are all just ",["$","strong",null,{"children":"tokens in an autoregressive chain"}],". The same architecture that powers GPT-4 can control a robot arm."]}],"\n",["$","h2",null,{"children":"2. Technical Requirements"}],"\n",["$","h3",null,{"children":"The Architecture"}],"\n",["$","p",null,{"children":"Your implementation must include:"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Multi-Head Causal Attention"}],": Ensuring that token ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"t"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"t"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6151em"}}],["$","span",null,{"className":"mord mathnormal","children":"t"}]]}]}]]}]," cannot attend to tokens ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"t"}],["$","mo",null,{"children":"+"}],["$","mn",null,{"children":"1"}],["$","mo",null,{"separator":"true","children":","}],["$","mo",null,{"children":"…"}],["$","mo",null,{"separator":"true","children":","}],["$","mi",null,{"children":"T"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"t+1, \\dots, T"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6984em","verticalAlign":"-0.0833em"}}],["$","span",null,{"className":"mord mathnormal","children":"t"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"+"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8778em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord","children":"1"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"minner","children":"…"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],"$Lf","$L10","$L11"]}]]}]]}],"."]}],"\n","$L12","\n","$L13","\n"]}],"\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c","\n","$L2d","\n","$L2e","\n","$L2f","\n","$L30","\n","$L31","\n","$L32","\n","$L33","\n","$L34","\n","$L35","\n","$L36","\n","$L37","\n","$L38","\n","$L39","\n","$L3a","\n","$L3b","\n","$L3c","\n","$L3d","\n","$L3e","\n","$L3f","\n","$L40","\n","$L41","\n","$L42","\n","$L43","\n","$L44","\n","$L45","\n","$L46","\n","$L47","\n","$L48","\n","$L49","\n","$L4a","\n","$L4b","\n","$L4c","\n","$L4d","\n","$L4e","\n","$L4f","\n","$L50","\n","$L51","\n","$L52","\n","$L53","\n","$L54","\n","$L55","\n","$L56","\n","$L57","\n","$L58","\n","$L59","\n","$L5a","\n","$L5b","\n","$L5c","\n","$L5d","\n","$L5e","\n","$L5f","\n","$L60","\n","$L61","\n","$L62","\n","$L63","\n","$L64","\n","$L65","\n","$L66","\n","$L67","\n","$L68","\n","$L69","\n","$L6a","\n","$L6b","\n","$L6c","\n","$L6d","\n","$L6e","\n","$L6f","\n","$L70","\n","$L71","\n","$L72","\n","$L73","\n","$L74","\n","$L75","\n","$L76","\n","$L77"]
f:["$","span",null,{"className":"mpunct","children":","}]
10:["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}]
11:["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"T"}]
12:["$","li",null,{"children":[["$","strong",null,{"children":"Rotary Positional Embeddings (RoPE)"}],": Implementing the relative positional encoding used in modern SOTA models like Llama-3 and PaLM-E."]}]
13:["$","li",null,{"children":[["$","strong",null,{"children":"RMSNorm"}],": Utilizing Root Mean Square Layer Normalization for improved training stability."]}]
14:["$","h3",null,{"children":"The Formalism"}]
15:["$","p",null,{"children":["Your model will minimize the negative log-likelihood of the sequence ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"mathvariant":"bold","children":"S"}],["$","mo",null,{"children":"="}],["$","mo",null,{"stretchy":"false","children":"{"}],["$","msub",null,{"children":[["$","mi",null,{"children":"s"}],["$","mn",null,{"children":"1"}]]}],["$","mo",null,{"separator":"true","children":","}],["$","msub",null,{"children":[["$","mi",null,{"children":"s"}],["$","mn",null,{"children":"2"}]]}],["$","mo",null,{"separator":"true","children":","}],["$","mo",null,{"children":"…"}],["$","mo",null,{"separator":"true","children":","}],["$","msub",null,{"children":[["$","mi",null,{"children":"s"}],["$","mi",null,{"children":"T"}]]}],["$","mo",null,{"stretchy":"false","children":"}"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\mathbf{S} = \\{s_1, s_2, \\dots, s_T\\}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6861em"}}],["$","span",null,{"className":"mord mathbf","children":"S"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"{"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"s"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3011em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"1"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"s"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3011em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"2"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"minner","children":"…"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"s"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3283em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.13889em"},"children":"T"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mclose","children":"}"}]]}]]}]]}],":"]}]
16:["$","p",null,{"children":["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"mathvariant":"script","children":"L"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"θ"}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"children":"="}],["$","mo",null,{"children":"−"}],["$","msubsup",null,{"children":[["$","mo",null,{"children":"∑"}],["$","mrow",null,{"children":[["$","mi",null,{"children":"t"}],["$","mo",null,{"children":"="}],["$","mn",null,{"children":"1"}]]}],["$","mi",null,{"children":"T"}]]}],["$","mi",null,{"children":"log"}],["$","mo",null,{"children":"⁡"}],["$","mi",null,{"children":"P"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","msub",null,{"children":[["$","mi",null,{"children":"s"}],["$","mi",null,{"children":"t"}]]}],["$","mi",null,{"mathvariant":"normal","children":"∣"}],["$","msub",null,{"children":[["$","mi",null,{"children":"s"}],["$","mrow",null,{"children":[["$","mo",null,{"children":"<"}],["$","mi",null,{"children":"t"}]]}]]}],["$","mo",null,{"separator":"true","children":";"}],["$","mi",null,{"children":"θ"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\mathcal{L}(\\theta) = -\\sum_{t=1}^{T} \\log P(s_t | s_{<t}; \\theta)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathcal","children":"L"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.02778em"},"children":"θ"}],["$","span",null,{"className":"mclose","children":")"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.2809em","verticalAlign":"-0.2997em"}}],["$","span",null,{"className":"mord","children":"−"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mop","children":[["$","span",null,{"className":"mop op-symbol small-op","style":{"position":"relative","top":"0em"},"children":"∑"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.9812em"},"children":[["$","span",null,{"style":{"top":"-2.4003em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","children":"t"}],["$","span",null,{"className":"mrel mtight","children":"="}],["$","span",null,{"className":"mord mtight","children":"1"}]]}]}]]}],["$","span",null,{"style":{"top":"-3.2029em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.13889em"},"children":"T"}]}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.2997em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mop","children":["lo",["$","span",null,{"style":{"marginRight":"0.01389em"},"children":"g"}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"P"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"s"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.2806em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"t"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":"$L78"}]]}]}]]}],"$L79","$L7a","$L7b","$L7c","$L7d","$L7e"]}]]}]]}]}]
17:["$","p",null,{"children":["Where each ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"s"}],["$","mi",null,{"children":"t"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"s_t"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.5806em","verticalAlign":"-0.15em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"s"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.2806em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"t"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]}]]}]," represents a tokenized robotic state (position ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"x"}],["$","mo",null,{"separator":"true","children":","}],["$","mi",null,{"children":"y"}],["$","mo",null,{"separator":"true","children":","}],["$","mi",null,{"children":"z"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"x, y, z"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"x"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"y"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}]]}]}]]}]," and orientation ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"q"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"q"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}]]}]}]]}],")."]}]
18:["$","h2",null,{"children":"3. Implementation Tasks"}]
19:["$","p",null,{"children":["Claude has scaffolded a template in the course repository under ",["$","code",null,{"children":"src/assignments/scratch-1/backbone.py"}],". You must complete the following blocks:"]}]
1a:["$","h3",null,{"children":"Task A: The Causal Self-Attention"}]
1b:["$","p",null,{"children":"Implement the scaled dot-product attention with a causal mask."}]
1c:["$","p",null,{"children":["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mtext",null,{"children":"Attention"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"Q"}],["$","mo",null,{"separator":"true","children":","}],["$","mi",null,{"children":"K"}],["$","mo",null,{"separator":"true","children":","}],["$","mi",null,{"children":"V"}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"children":"="}],["$","mtext",null,{"children":"softmax"}],["$","mrow",null,{"children":[["$","mo",null,{"fence":"true","children":"("}],["$","mfrac",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"Q"}],["$","msup",null,{"children":[["$","mi",null,{"children":"K"}],["$","mi",null,{"children":"T"}]]}],["$","mo",null,{"children":"+"}],["$","mi",null,{"children":"M"}]]}],["$","msqrt",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"k"}]]}]}]]}],["$","mo",null,{"fence":"true","children":")"}]]}],["$","mi",null,{"children":"V"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\text{Attention}(Q, K, V) = \\text{softmax}\\left(\\frac{QK^T + M}{\\sqrt{d_k}}\\right)V"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"Attention"}]}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"Q"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07153em"},"children":"K"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.22222em"},"children":"V"}],["$","span",null,{"className":"mclose","children":")"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.8em","verticalAlign":"-0.65em"}}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"softmax"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"minner","children":[["$","span",null,{"className":"mopen delimcenter","style":{"top":"0em"},"children":["$","span",null,{"className":"delimsizing size2","children":"("}]}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mopen nulldelimiter"}],["$","span",null,{"className":"mfrac","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"1.0895em"},"children":[["$","span",null,{"style":{"top":"-2.5864em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord sqrt mtight","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.8622em"},"children":[["$","span",null,{"className":"svg-align","style":{"top":"-3em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord mtight","style":{"paddingLeft":"0.833em"},"children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3448em"},"children":["$","span",null,{"style":{"top":"-2.3488em","marginLeft":"0em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03148em"},"children":"k"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.1512em"},"children":["$","span",null,{}]}]}]]}]}]]}]}]]}],"$L7f"]}],"$L80"]}],"$L81"]}]}]}]}]]}],"$L82","$L83"]}],"$L84"]}],"$L85"]}]}],"$L86"]}],"$L87"]}],"$L88","$L89"]}]]}]]}]}]
1d:["$","p",null,{"children":["Where ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"M"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"M"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"M"}]]}]}]]}]," is the mask matrix: ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","msub",null,{"children":[["$","mi",null,{"children":"M"}],["$","mrow",null,{"children":[["$","mi",null,{"children":"i"}],["$","mi",null,{"children":"j"}]]}]]}],["$","mo",null,{"children":"="}],["$","mn",null,{"children":"0"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"M_{ij} = 0"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.9694em","verticalAlign":"-0.2861em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"M"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.109em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.05724em"},"children":"ij"}]}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.2861em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6444em"}}],["$","span",null,{"className":"mord","children":"0"}]]}]]}]]}]," for ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"i"}],["$","mo",null,{"children":"≥"}],["$","mi",null,{"children":"j"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"i \\ge j"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.7955em","verticalAlign":"-0.136em"}}],["$","span",null,{"className":"mord mathnormal","children":"i"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"≥"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.854em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.05724em"},"children":"j"}]]}]]}]]}]," and ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mo",null,{"children":"−"}],["$","mi",null,{"mathvariant":"normal","children":"∞"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"-\\infty"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6667em","verticalAlign":"-0.0833em"}}],["$","span",null,{"className":"mord","children":"−"}],["$","span",null,{"className":"mord","children":"∞"}]]}]}]]}]," otherwise."]}]
1e:["$","p",null,{"children":[["$","strong",null,{"children":"Key Points"}],":"]}]
1f:["$","ul",null,{"children":["\n",["$","li",null,{"children":"The mask prevents tokens from attending to future tokens"}],"\n",["$","li",null,{"children":["Use ",["$","code",null,{"children":"torch.tril"}]," to create the causal mask"]}],"\n",["$","li",null,{"children":"Apply mask before the softmax operation"}],"\n",["$","li",null,{"children":"Handle the multi-head dimension correctly"}],"\n"]}]
20:["$","h3",null,{"children":"Task B: The RMSNorm Block"}]
21:["$","p",null,{"children":"Implement the normalization layer defined by:"}]
22:["$","p",null,{"children":["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","msub",null,{"children":[["$","mover",null,{"accent":"true","children":[["$","mi",null,{"children":"a"}],["$","mo",null,{"children":"ˉ"}]]}],["$","mi",null,{"children":"i"}]]}],["$","mo",null,{"children":"="}],["$","mfrac",null,{"children":[["$","msub",null,{"children":[["$","mi",null,{"children":"a"}],["$","mi",null,{"children":"i"}]]}],["$","msqrt",null,{"children":["$","mrow",null,{"children":[["$","mfrac",null,{"children":[["$","mn",null,{"children":"1"}],["$","mi",null,{"children":"n"}]]}],["$","msubsup",null,{"children":[["$","mo",null,{"children":"∑"}],["$","mrow",null,{"children":[["$","mi",null,{"children":"j"}],["$","mo",null,{"children":"="}],["$","mn",null,{"children":"1"}]]}],["$","mi",null,{"children":"n"}]]}],["$","msubsup",null,{"children":[["$","mi",null,{"children":"a"}],["$","mi",null,{"children":"j"}],["$","mn",null,{"children":"2"}]]}],["$","mo",null,{"children":"+"}],["$","mi",null,{"children":"ϵ"}]]}]}]]}],["$","mo",null,{"children":"⋅"}],["$","msub",null,{"children":[["$","mi",null,{"children":"g"}],["$","mi",null,{"children":"i"}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\bar{a}_i = \\frac{a_i}{\\sqrt{\\frac{1}{n} \\sum_{j=1}^n a_j^2 + \\epsilon}} \\cdot g_i"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.7178em","verticalAlign":"-0.15em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord accent","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.5678em"},"children":[["$","span",null,{"style":{"top":"-3em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord mathnormal","children":"a"}]]}],["$","span",null,{"style":{"top":"-3em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"accent-body","style":{"left":"-0.25em"},"children":["$","span",null,{"className":"mord","children":"ˉ"}]}]]}]]}]}]}]}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.5411em","verticalAlign":"-0.8296em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mopen nulldelimiter"}],["$","span",null,{"className":"mfrac","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.7115em"},"children":[["$","span",null,{"style":{"top":"-2.5051em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord sqrt mtight","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.9785em"},"children":[["$","span",null,{"className":"svg-align","style":{"top":"-3.4286em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3.4286em"}}],["$","span",null,{"className":"mord mtight","style":{"paddingLeft":"1.19em"},"children":[["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mopen nulldelimiter sizing reset-size3 size6"}],["$","span",null,{"className":"mfrac","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.8443em"},"children":[["$","span",null,{"style":{"top":"-2.656em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":"$L8a"}]]}],"$L8b","$L8c"]}],"$L8d"]}],"$L8e"]}]}],"$L8f"]}],"$L90","$L91","$L92","$L93","$L94","$L95"]}]]}],"$L96"]}],"$L97"]}],"$L98"]}]}]}]}]]}],"$L99","$L9a"]}],"$L9b"]}],"$L9c"]}]}],"$L9d"]}],"$L9e","$L9f","$La0"]}],"$La1"]}]]}]}]
23:["$","p",null,{"children":"Where:"}]
24:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"a"}],["$","mi",null,{"children":"i"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"a_i"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.5806em","verticalAlign":"-0.15em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"a"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]}]]}]," is the input activation"]}],"\n",["$","li",null,{"children":[["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"n"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"n"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","children":"n"}]]}]}]]}]," is the dimension"]}],"\n",["$","li",null,{"children":[["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"ϵ"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\epsilon"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","children":"ϵ"}]]}]}]]}]," is a small constant for numerical stability (typically ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msup",null,{"children":[["$","mn",null,{"children":"10"}],["$","mrow",null,{"children":[["$","mo",null,{"children":"−"}],["$","mn",null,{"children":"6"}]]}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"10^{-6}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8141em"}}],["$","span",null,{"className":"mord","children":"1"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord","children":"0"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8141em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mtight","children":"−"}],["$","span",null,{"className":"mord mtight","children":"6"}]]}]}]]}]}]}]}]}]]}]]}]}]]}],")"]}],"\n",["$","li",null,{"children":[["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"g"}],["$","mi",null,{"children":"i"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"g_i"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],"$La2"]}]}]]}]," is a learned scaling parameter"]}],"\n"]}]
25:["$","p",null,{"children":[["$","strong",null,{"children":"Key Points"}],":"]}]
26:["$","ul",null,{"children":["\n",["$","li",null,{"children":"RMSNorm is simpler and faster than LayerNorm (no mean subtraction)"}],"\n",["$","li",null,{"children":"Used in modern LLMs like Llama-3"}],"\n",["$","li",null,{"children":["The scaling parameter ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"g"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"g"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"g"}]]}]}]]}]," is learned during training"]}],"\n"]}]
27:["$","h3",null,{"children":"Task C: The Training Loop"}]
28:["$","p",null,{"children":"Write a training loop that processes a batch of synthetic trajectories, calculates the cross-entropy loss, and performs backpropagation."}]
29:["$","p",null,{"children":[["$","strong",null,{"children":"Requirements"}],":"]}]
2a:["$","ul",null,{"children":["\n",["$","li",null,{"children":"Process batches of sequences"}],"\n",["$","li",null,{"children":"Compute loss using teacher forcing"}],"\n",["$","li",null,{"children":"Implement gradient clipping (max norm = 1.0)"}],"\n",["$","li",null,{"children":"Log training metrics (loss, perplexity)"}],"\n",["$","li",null,{"children":"Save checkpoints every 1000 steps"}],"\n"]}]
2b:["$","h2",null,{"children":"4. Dataset: Synthetic Trajectories"}]
2c:["$","p",null,{"children":["We provide a script ",["$","code",null,{"children":"src/assignments/scratch-1/generate_data.py"}]," that creates 10,000 synthetic robot trajectories. Each trajectory consists of a 7-DOF robot arm moving toward a target."]}]
2d:["$","p",null,{"children":[["$","strong",null,{"children":"Dataset Specifications"}],":"]}]
2e:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"State Space"}],": 7-DOF joint angles + 3D end-effector position"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Action Space"}],": Discretized into 256 bins per dimension"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Sequence Length"}],": 50 timesteps per trajectory"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Vocabulary Size"}],": 256 tokens"]}],"\n"]}]
2f:["$","p",null,{"children":[["$","strong",null,{"children":"Data Format"}],":"]}]
30:["$","pre",null,{"children":["$","code",null,{"className":"language-python","children":"{\n    'trajectories': torch.Tensor,  # Shape: (10000, 50, 10)\n    'tokenized': torch.LongTensor  # Shape: (10000, 50) - discretized actions\n}\n"}]}]
31:["$","h3",null,{"children":"Generating the Dataset"}]
32:["$","pre",null,{"children":["$","code",null,{"className":"language-bash","children":"cd src/assignments/scratch-1\npython generate_data.py --output data/trajectories.pkl\n"}]}]
33:["$","h2",null,{"children":"5. Submission"}]
34:["$","h3",null,{"children":"Code Submission"}]
35:["$","p",null,{"children":["Commit your implementation to your student branch in the ",["$","code",null,{"children":"arpg/vla-foundations"}]," repo:"]}]
36:["$","pre",null,{"children":["$","code",null,{"className":"language-bash","children":"git checkout -b scratch-1-yourname\ngit add src/assignments/scratch-1/backbone.py\ngit commit -m \"Complete Scratch-1: Transformer Backbone\"\ngit push origin scratch-1-yourname\n"}]}]
37:["$","p",null,{"children":["Open a pull request to the ",["$","code",null,{"children":"staging"}]," branch with:"]}]
38:["$","ul",null,{"children":["\n",["$","li",null,{"children":["Title: ",["$","code",null,{"children":"Scratch-1: [Your Name]"}]]}],"\n",["$","li",null,{"children":"Description: Brief summary of your implementation"}],"\n"]}]
39:["$","h3",null,{"children":"Report Submission"}]
3a:["$","p",null,{"children":["Create an MDX page at ",["$","code",null,{"children":"content/course/submissions/scratch-1/[your-name].mdx"}]," with the following sections:"]}]
3b:["$","h4",null,{"children":"Required Content"}]
3c:["$","ol",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Loss Curve"}],": Plot training loss over iterations"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Attention Maps"}],": Visualize attention patterns for a sample trajectory"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"The Audit"}],": Explain what happens to the loss if you remove the Causal Mask. Why does the model \"cheat\"?"]}],"\n"]}]
3d:["$","h4",null,{"children":"Template"}]
3e:["$","pre",null,{"children":["$","code",null,{"className":"language-mdx","children":"---\ntitle: \"Scratch-1 Submission: Your Name\"\nstudent: \"Your Name\"\ndate: \"2026-02-01\"\n---\n\n# Scratch-1: The Transformer Backbone\n\n## Loss Curve\n\n![Training Loss](./images/loss_curve.png)\n\nThe model converged after X iterations with final loss of Y.\n\n## Attention Visualization\n\n![Attention Maps](./images/attention_maps.png)\n\nThe attention patterns show...\n\n## The Audit: Removing the Causal Mask\n\nWhen I removed the causal mask, the following happened:\n\n[Your analysis here]\n\n### Why the Model \"Cheats\"\n\n[Your explanation here]\n\n## Code Highlights\n\n[Optional: Highlight interesting implementation details]\n\n## Challenges and Solutions\n\n[Optional: Discuss difficulties you encountered]\n"}]}]
3f:["$","h2",null,{"children":"6. Grading Rubric"}]
40:["$","h3",null,{"children":"Pass Level (B): 70-89 points"}]
41:["$","ul",null,{"children":["\n",["$","li",null,{"children":"✅ Successful implementation of the backbone"}],"\n",["$","li",null,{"children":["✅ Loss shows clear convergence (appreciable decrease from initial loss)","\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Expected: Initial loss ~3-4, Final loss ~1.9-2.2"}],"\n",["$","li",null,{"children":"Model should demonstrate learning, not achieve arbitrary threshold"}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":"✅ Attention maps visualization included"}],"\n",["$","li",null,{"children":"✅ Causal mask audit completed"}],"\n",["$","li",null,{"children":"✅ Code is clean and documented"}],"\n"]}]
42:["$","h3",null,{"children":"Mastery Level (A): 90-100 points"}]
43:["$","p",null,{"children":"All Pass Level requirements, plus:"}]
44:["$","ul",null,{"children":["\n",["$","li",null,{"children":["✅ ",["$","strong",null,{"children":"KV-Caching"}]," implemented for efficient inference"]}],"\n",["$","li",null,{"children":["✅ ",["$","strong",null,{"children":"Rigorous derivation"}]," of why RoPE is superior to Sinusoidal embeddings for spatial data"]}],"\n",["$","li",null,{"children":"✅ Ablation study comparing RoPE vs. Sinusoidal positional encodings"}],"\n",["$","li",null,{"children":"✅ Inference speed comparison with and without KV-caching"}],"\n"]}]
45:["$","h3",null,{"children":"Detailed Breakdown"}]
46:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Component"}],["$","th",null,{"children":"Points"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","strong",null,{"children":"Implementation"}]}],["$","td",null,{"children":["$","strong",null,{"children":"50"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- Causal Self-Attention (correct masking)"}],["$","td",null,{"children":"15"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- RMSNorm (correct implementation)"}],["$","td",null,{"children":"10"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- RoPE (correct rotation application)"}],["$","td",null,{"children":"15"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- Training loop (convergence)"}],["$","td",null,{"children":"10"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","strong",null,{"children":"Report"}]}],["$","td",null,{"children":["$","strong",null,{"children":"30"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- Loss curve (clear visualization)"}],["$","td",null,{"children":"10"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- Attention maps (informative)"}],["$","td",null,{"children":"10"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- Causal mask audit (insightful analysis)"}],["$","td",null,{"children":"10"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","strong",null,{"children":"Code Quality"}]}],["$","td",null,{"children":["$","strong",null,{"children":"20"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- Clean, readable code"}],["$","td",null,{"children":"10"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- Proper documentation"}],["$","td",null,{"children":"5"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- Git workflow (clear commits)"}],["$","td",null,{"children":"5"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","strong",null,{"children":"Mastery Bonus"}]}],["$","td",null,{"children":["$","strong",null,{"children":"+10"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- KV-Caching implementation"}],["$","td",null,{"children":"5"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"- RoPE derivation and ablation"}],["$","td",null,{"children":"5"}]]}]]}]]}]
47:["$","h2",null,{"children":"7. Resources"}]
48:["$","h3",null,{"children":"Attention Mechanism"}]
49:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","a",null,{"href":"https://arxiv.org/abs/1706.03762","children":"Attention Is All You Need"}]," (Vaswani et al., 2017)"]}],"\n",["$","li",null,{"children":[["$","a",null,{"href":"https://jalammar.github.io/illustrated-transformer/","children":"Illustrated Transformer"}]," (Jay Alammar)"]}],"\n"]}]
4a:["$","h3",null,{"children":"RoPE (Rotary Position Embedding)"}]
4b:["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"https://arxiv.org/abs/2104.09864","children":"RoFormer: Enhanced Transformer with Rotary Position Embedding"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://blog.eleuther.ai/rotary-embeddings/","children":"Understanding RoPE"}]}],"\n"]}]
4c:["$","h3",null,{"children":"RMSNorm"}]
4d:["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"https://arxiv.org/abs/1910.07467","children":"Root Mean Square Layer Normalization"}]}],"\n",["$","li",null,{"children":"Used in Llama-3, Grok, and modern LLMs"}],"\n"]}]
4e:["$","h3",null,{"children":"PyTorch"}]
4f:["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"https://pytorch.org/tutorials/beginner/examples_nn/two_layer_net_module.html","children":"PyTorch nn.Module Tutorial"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://einops.rocks/","children":"Einops for Tensor Operations"}]}],"\n"]}]
50:["$","h2",null,{"children":"8. Getting Started"}]
51:["$","h3",null,{"children":"1. Generate the Dataset"}]
52:["$","pre",null,{"children":["$","code",null,{"className":"language-bash","children":"cd src/assignments/scratch-1\npython generate_data.py --num_trajectories 10000 --seq_length 50\n"}]}]
53:["$","h3",null,{"children":"2. Review the Template"}]
54:["$","p",null,{"children":["Open ",["$","code",null,{"children":"src/assignments/scratch-1/backbone.py"}]," and locate the ",["$","code",null,{"children":"# TODO"}]," markers."]}]
55:["$","h3",null,{"children":"3. Implement the Components"}]
56:["$","p",null,{"children":"Start with RMSNorm (simplest), then move to Attention, then the full model."}]
57:["$","h3",null,{"children":"4. Train the Model"}]
58:["$","pre",null,{"children":["$","code",null,{"className":"language-bash","children":"python train.py --data data/trajectories.pkl --epochs 10\n"}]}]
59:["$","h3",null,{"children":"5. Visualize Results"}]
5a:["$","pre",null,{"children":["$","code",null,{"className":"language-bash","children":"python visualize.py --checkpoint checkpoints/best_model.pt\n"}]}]
5b:["$","h2",null,{"children":"9. Common Pitfalls"}]
5c:["$","h3",null,{"children":"Attention Masking"}]
5d:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Mistake"}],": Applying mask after softmax"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Fix"}],": Mask must be applied before softmax (",["$","code",null,{"children":"logits + mask"}],")"]}],"\n"]}]
5e:["$","h3",null,{"children":"RoPE Implementation"}]
5f:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Mistake"}],": Rotating the entire embedding"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Fix"}],": Only rotate pairs of dimensions (see template)"]}],"\n"]}]
60:["$","h3",null,{"children":"Training Instability"}]
61:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Mistake"}],": No gradient clipping"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Fix"}],": Use ",["$","code",null,{"children":"torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)"}]]}],"\n"]}]
62:["$","h3",null,{"children":"Memory Issues"}]
63:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Mistake"}],": Storing entire attention matrix"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Fix"}],": Use efficient attention implementations or smaller batch sizes"]}],"\n"]}]
64:["$","h2",null,{"children":"10. FAQs"}]
65:["$","p",null,{"children":[["$","strong",null,{"children":"Q: Can I use einops for cleaner tensor operations?"}],"\nA: Yes, but document what each einops operation does."]}]
66:["$","p",null,{"children":[["$","strong",null,{"children":"Q: Can I use Flash Attention?"}],"\nA: Not for the base implementation. Flash Attention can be used for the Mastery bonus."]}]
67:["$","p",null,{"children":[["$","strong",null,{"children":"Q: How long should training take?"}],"\nA: On a single GPU: ~10-15 minutes for 10k trajectories. On CPU: ~1 hour."]}]
68:["$","p",null,{"children":[["$","strong",null,{"children":"Q: What batch size should I use?"}],"\nA: Start with 32. Increase if you have more VRAM."]}]
69:["$","p",null,{"children":[["$","strong",null,{"children":"Q: My loss isn't converging. Help?"}],"\nA: Check:"]}]
6a:["$","ol",null,{"children":["\n",["$","li",null,{"children":"Is the causal mask applied correctly?"}],"\n",["$","li",null,{"children":"Is the learning rate too high? (Try 1e-4)"}],"\n",["$","li",null,{"children":"Are gradients exploding? (Enable gradient clipping)"}],"\n"]}]
6b:["$","p",null,{"children":[["$","strong",null,{"children":"Q: What loss should I expect?"}],"\nA: With correct implementation on the synthetic trajectory dataset:"]}]
6c:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Initial loss"}],": ~3-4 (near random guessing for 256-way classification)"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Final loss"}],": ~1.9-2.2 (showing clear learning)"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Key metric"}],": Appreciable decrease indicating the model learns patterns"]}],"\n",["$","li",null,{"children":"The action encoding represents direction + magnitude toward target, which is learnable but not trivial"}],"\n"]}]
6d:["$","h2",null,{"children":"11. Deadline"}]
6e:["$","p",null,{"children":[["$","strong",null,{"children":"Due"}],": Sunday, February 1, 9:00 AM MST"]}]
6f:["$","p",null,{"children":"Late submissions: 10% penalty per day (max 3 days late)"}]
70:["$","h2",null,{"children":"12. Office Hours"}]
71:["$","p",null,{"children":"If you're stuck, attend office hours or post in the discussion forum. Common questions:"}]
72:["$","ul",null,{"children":["\n",["$","li",null,{"children":"Debugging attention masks"}],"\n",["$","li",null,{"children":"Understanding RoPE rotation matrices"}],"\n",["$","li",null,{"children":"Interpreting loss curves"}],"\n"]}]
73:["$","h2",null,{"children":"13. Collaboration Policy"}]
74:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Allowed"}],": Discussing concepts, debugging together"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Not Allowed"}],": Copying code, sharing implementations"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Required"}],": Document any external resources used (StackOverflow, papers, blog posts)"]}],"\n"]}]
75:["$","p",null,{"children":"Good luck! This assignment will give you a deep understanding of how modern VLA models work under the hood."}]
76:["$","hr",null,{}]
77:["$","p",null,{"children":[["$","em",null,{"children":"\"The Transformer is not magic. It's just matrix multiplications and softmax.\""}]," — Andrej Karpathy"]}]
78:["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]
79:["$","span",null,{"className":"mord","children":"∣"}]
7a:["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"s"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.2806em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mrel mtight","children":"<"}],["$","span",null,{"className":"mord mathnormal mtight","children":"t"}]]}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.1774em"},"children":["$","span",null,{}]}]}]]}]}]]}]
7b:["$","span",null,{"className":"mpunct","children":";"}]
7c:["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}]
7d:["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.02778em"},"children":"θ"}]
7e:["$","span",null,{"className":"mclose","children":")"}]
7f:["$","span",null,{"style":{"top":"-2.8222em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"hide-tail mtight","style":{"minWidth":"0.853em","height":"1.08em"},"children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":"400em","height":"1.08em","viewBox":"0 0 400000 1080","preserveAspectRatio":"xMinYMin slice","children":["$","path",null,{"d":"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"}]}]}]]}]
80:["$","span",null,{"className":"vlist-s","children":"​"}]
81:["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.1778em"},"children":["$","span",null,{}]}]}]
82:["$","span",null,{"style":{"top":"-3.23em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"frac-line","style":{"borderBottomWidth":"0.04em"}}]]}]
83:["$","span",null,{"style":{"top":"-3.4461em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","children":"Q"}],["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.07153em"},"children":"K"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.9191em"},"children":["$","span",null,{"style":{"top":"-2.931em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.13889em"},"children":"T"}]}]]}]}]}]}]}]]}],["$","span",null,{"className":"mbin mtight","children":"+"}],["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.10903em"},"children":"M"}]]}]}]]}]
84:["$","span",null,{"className":"vlist-s","children":"​"}]
85:["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.538em"},"children":["$","span",null,{}]}]}]
86:["$","span",null,{"className":"mclose nulldelimiter"}]
87:["$","span",null,{"className":"mclose delimcenter","style":{"top":"0em"},"children":["$","span",null,{"className":"delimsizing size2","children":")"}]}]
88:["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}]
89:["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.22222em"},"children":"V"}]
8a:["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"n"}]}]
8b:["$","span",null,{"style":{"top":"-3.2255em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"frac-line mtight","style":{"borderBottomWidth":"0.049em"}}]]}]
8c:["$","span",null,{"style":{"top":"-3.384em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"1"}]}]}]]}]
8d:["$","span",null,{"className":"vlist-s","children":"​"}]
8e:["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.344em"},"children":["$","span",null,{}]}]}]
8f:["$","span",null,{"className":"mclose nulldelimiter sizing reset-size3 size6"}]
90:["$","span",null,{"className":"mspace mtight","style":{"marginRight":"0.1952em"}}]
91:["$","span",null,{"className":"mop mtight","children":[["$","span",null,{"className":"mop op-symbol small-op mtight","style":{"position":"relative","top":"0em"},"children":"∑"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.7047em"},"children":[["$","span",null,{"style":{"top":"-2.1786em","marginLeft":"0em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.05724em"},"children":"j"}],["$","span",null,{"className":"mrel mtight","children":"="}],["$","span",null,{"className":"mord mtight","children":"1"}]]}]}]]}],["$","span",null,{"style":{"top":"-2.8971em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"n"}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.4603em"},"children":["$","span",null,{}]}]}]]}]}]]}]
92:["$","span",null,{"className":"mspace mtight","style":{"marginRight":"0.1952em"}}]
93:["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","children":"a"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.8051em"},"children":[["$","span",null,{"style":{"top":"-2.1777em","marginLeft":"0em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.05724em"},"children":"j"}]}]]}],["$","span",null,{"style":{"top":"-2.8448em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mtight","children":"2"}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.4612em"},"children":["$","span",null,{}]}]}]]}]}]]}]
94:["$","span",null,{"className":"mbin mtight","children":"+"}]
95:["$","span",null,{"className":"mord mathnormal mtight","children":"ϵ"}]
96:["$","span",null,{"style":{"top":"-2.9505em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3.4286em"}}],["$","span",null,{"className":"hide-tail mtight","style":{"minWidth":"0.853em","height":"1.5429em"},"children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":"400em","height":"1.5429em","viewBox":"0 0 400000 1080","preserveAspectRatio":"xMinYMin slice","children":["$","path",null,{"d":"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"}]}]}]]}]
97:["$","span",null,{"className":"vlist-s","children":"​"}]
98:["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.4781em"},"children":["$","span",null,{}]}]}]
99:["$","span",null,{"style":{"top":"-3.23em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"frac-line","style":{"borderBottomWidth":"0.04em"}}]]}]
9a:["$","span",null,{"style":{"top":"-3.4101em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","children":"a"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3281em"},"children":["$","span",null,{"style":{"top":"-2.357em","marginLeft":"0em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.143em"},"children":["$","span",null,{}]}]}]]}]}]]}]}]}]]}]
9b:["$","span",null,{"className":"vlist-s","children":"​"}]
9c:["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8296em"},"children":["$","span",null,{}]}]}]
9d:["$","span",null,{"className":"mclose nulldelimiter"}]
9e:["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]
9f:["$","span",null,{"className":"mbin","children":"⋅"}]
a0:["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]
a1:["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"g"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.0359em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]
a2:["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"g"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.0359em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]
9:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
a3:I[27654,["/staging/pulls/52/_next/static/chunks/3421e88d40c9134c.js","/staging/pulls/52/_next/static/chunks/fbf372f7eb8336a2.js"],"IconMark"]
7:null
b:[["$","title","0",{"children":"Scratch-1: The Transformer Backbone - VLA Foundations"}],["$","meta","1",{"name":"description","content":"Assignment: Scratch-1: The Transformer Backbone"}],["$","link","2",{"rel":"icon","href":"/staging/pulls/52/favicon.ico?favicon.0b3bf435.ico","sizes":"256x256","type":"image/x-icon"}],["$","$La3","3",{}]]
